# ============================================================================

# ===================================
# SSL/TLS CONFIGURATION (DESARROLLO LOCAL)
# ===================================
SSL_ENABLED=false                    # true para habilitar HTTPS en desarrollo
NODE_ENV=development
FRONTEND_URL=http://localhost:3000   # URL del frontend Next.js
PORT=4100                            # Puerto principal (HTTPS si SSL_ENABLED=true)
HTTP_PORT=4000                       # Puerto HTTP auxiliar (solo desarrollo con SSL)
HOST=0.0.0.0

# ============================================================================
# BASE DE DATOS - MONGODB
# ============================================================================
# MongoDB Local
MONGO_URI=mongodb://localhost:27017/cermont_db

# MongoDB Atlas (Producción - Ejemplo)
# MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/cermont_db?retryWrites=true&w=majority

# MongoDB de Testing
MONGO_TEST_URI=mongodb://localhost:27017/cermont_test_db

# ============================================================================
# JWT - AUTENTICACIÓN CON JOSE (2025)
# ============================================================================
# IMPORTANTE: Cambiar estos secrets en producción (mínimo 32 caracteres)
# jose requiere strings seguros para TextEncoder
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars-1234567890abcdef
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-refresh-secret-key-change-in-production-min-32-chars-fedcba0987654321
JWT_REFRESH_EXPIRES_IN=7d

# Algoritmo de firma (jose soporta: HS256, HS384, HS512, RS256, ES256)
JWT_ALGORITHM=HS256

# ============================================================================
# PASSWORD HASHING - ARGON2 (2025)
# ============================================================================
# Argon2 configuración (más seguro que bcrypt)
ARGON2_TYPE=argon2id
ARGON2_MEMORY_COST=65536
ARGON2_TIME_COST=3
ARGON2_PARALLELISM=1

# Mantener compatibilidad con bcrypt para usuarios existentes
ENABLE_BCRYPT_FALLBACK=true

# ============================================================================
# CORS - ORÍGENES PERMITIDOS
# ============================================================================
# Separar múltiples orígenes con comas
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:4173,https://cermont.app

# Métodos HTTP permitidos
CORS_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS

# Headers permitidos
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# Habilitar credentials (cookies, authorization headers)
CORS_CREDENTIALS=true

# ============================================================================
# ALMACENAMIENTO DE ARCHIVOS - MULTER 2.0
# ============================================================================
STORAGE_DIR=./uploads
MAX_FILE_SIZE=10485760

# Tipos MIME permitidos (separados por comas)
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/jpg,image/webp,image/gif,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/plain,text/csv

# Configuración de subdirectorios
UPLOAD_EVIDENCES_DIR=uploads/evidences
UPLOAD_ORDERS_DIR=uploads/orders
UPLOAD_REPORTS_DIR=uploads/reports
UPLOAD_PROFILES_DIR=uploads/profiles

# ============================================================================
# RATE LIMITING - PROTECCIÓN CONTRA ATAQUES
# ============================================================================
# Ventana de tiempo en milisegundos (15 minutos)
RATE_LIMIT_WINDOW_MS=900000

# Máximo de requests por ventana (general)
RATE_LIMIT_MAX_REQUESTS=100

# Rate limit para autenticación (más restrictivo)
AUTH_RATE_LIMIT_MAX=5
AUTH_RATE_LIMIT_WINDOW_MS=900000

# Rate limit para upload de archivos
UPLOAD_RATE_LIMIT_MAX=20
UPLOAD_RATE_LIMIT_WINDOW_MS=600000

# Habilitar rate limiting
ENABLE_RATE_LIMITING=true

# ============================================================================
# CONFIGURACIÓN DE EMAIL (OPCIONAL - PARA NOTIFICACIONES)
# ============================================================================
EMAIL_ENABLED=false
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=noreply@cermont.com
EMAIL_PASSWORD=your-app-password-here
EMAIL_FROM=CERMONT ATG <noreply@cermont.com>
EMAIL_REPLY_TO=soporte@cermont.com

# Plantillas de email
EMAIL_TEMPLATES_DIR=./src/templates/emails

# ============================================================================
# URL DEL FRONTEND
# ============================================================================
FRONTEND_URL=http://localhost:3000

# URL para reset de contraseña
PASSWORD_RESET_URL=http://localhost:3000/reset-password

# ============================================================================
# LOGGING - WINSTON
# ============================================================================
LOG_LEVEL=info
LOG_DIR=./logs

# Máximo tamaño de archivo de log (10MB)
LOG_MAX_SIZE=10485760

# Máximo número de archivos de log rotados
LOG_MAX_FILES=5

# Formato de log (json, simple, colorize)
LOG_FORMAT=json

# Habilitar logging en consola
LOG_CONSOLE=true

# Habilitar logging en archivos
LOG_FILE=true

# ============================================================================
# ARCHIVADO AUTOMÁTICO DE ÓRDENES
# ============================================================================
ARCHIVE_ENABLED=true

# Días antes de archivar órdenes completadas
ARCHIVE_INTERVAL_DAYS=90

# Directorio de archivos
ARCHIVE_DIR=./archives

# ============================================================================
# SOCKET.IO - WEBSOCKETS
# ============================================================================
SOCKET_IO_PING_TIMEOUT=60000
SOCKET_IO_PING_INTERVAL=25000

# CORS para Socket.IO
SOCKET_IO_CORS_ORIGIN=http://localhost:3000,http://localhost:5173

# Transporte permitido (websocket, polling)
SOCKET_IO_TRANSPORTS=websocket,polling

# Habilitar Socket.IO
ENABLE_SOCKET_IO=true

# ============================================================================
# SEGURIDAD ADICIONAL
# ============================================================================
# Tiempo de expiración de tokens de reset de contraseña (1 hora)
PASSWORD_RESET_EXPIRES=3600000

# Tiempo de bloqueo de cuenta tras intentos fallidos (15 minutos)
ACCOUNT_LOCKOUT_TIME=900000

# Máximo de intentos de login antes de bloquear
MAX_LOGIN_ATTEMPTS=5

# Helmet - Configuración de seguridad HTTP
HELMET_ENABLED=true
HELMET_CSP_ENABLED=false

# HTTPS en producción
FORCE_HTTPS=false

# Cookie segura (solo en producción con HTTPS)
COOKIE_SECURE=false
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE=lax

# ============================================================================
# PAGINACIÓN
# ============================================================================
DEFAULT_PAGE_SIZE=10
MAX_PAGE_SIZE=100

# ============================================================================
# MONITOREO Y ANALYTICS (OPCIONAL)
# ============================================================================
ENABLE_METRICS=false

# Sentry para error tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# APM (Application Performance Monitoring)
APM_ENABLED=false

# ============================================================================
# BACKUP AUTOMÁTICO (OPCIONAL)
# ============================================================================
BACKUP_ENABLED=false
BACKUP_INTERVAL_HOURS=24
BACKUP_DIR=./backups
BACKUP_RETENTION_DAYS=30

# Comando de backup de MongoDB
MONGO_BACKUP_COMMAND=mongodump

# ============================================================================
# CACHE (OPCIONAL - REDIS)
# ============================================================================
CACHE_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
CACHE_TTL=3600

# ============================================================================
# NOTIFICACIONES PUSH (OPCIONAL - FIREBASE)
# ============================================================================
PUSH_NOTIFICATIONS_ENABLED=false
FIREBASE_PROJECT_ID=
FIREBASE_PRIVATE_KEY=
FIREBASE_CLIENT_EMAIL=

# ============================================================================
# GEOLOCALIZACIÓN (OPCIONAL)
# ============================================================================
GEOLOCATION_ENABLED=false
GOOGLE_MAPS_API_KEY=

# ============================================================================
# CRON JOBS
# ============================================================================
# Habilitar tareas programadas
ENABLE_CRON_JOBS=true

# Horario de backup (cron syntax: 0 2 * * * = 2 AM diario)
CRON_BACKUP=0 2 * * *

# Horario de archivado (3 AM diario)
CRON_ARCHIVE=0 3 * * *

# Horario de limpieza de logs (domingo 4 AM)
CRON_CLEANUP_LOGS=0 4 * * 0

# ============================================================================
# TIMEZONE
# ============================================================================
TZ=America/Bogota

# ============================================================================
# DEBUGGING
# ============================================================================
# Habilitar modo debug
DEBUG=false

# Verbose logging
VERBOSE=false

# Mostrar stack traces completos
SHOW_STACK_TRACE=true

# ============================================================================
# PERFORMANCE
# ============================================================================
# Número de workers para cluster mode (0 = número de CPUs)
CLUSTER_WORKERS=0

# Habilitar compresión gzip
ENABLE_COMPRESSION=true

# Timeout de requests (30 segundos)
REQUEST_TIMEOUT=30000

# ============================================================================
# TESTING
# ============================================================================
# Puerto para servidor de testing
TEST_PORT=4101

# Base de datos de testing
TEST_DB=cermont_test_db

# Timeout para tests
TEST_TIMEOUT=10000

# ============================================================================
# VERSIÓN DE LA API
# ============================================================================
API_VERSION=1.0.0
API_PREFIX=/api/v1

# ============================================================================
# DOCUMENTACIÓN
# ============================================================================
# Habilitar Swagger/OpenAPI
ENABLE_SWAGGER=false
SWAGGER_PATH=/api-docs

# ============================================================================
# MANTENIMIENTO
# ============================================================================
# Modo mantenimiento (deshabilita todas las rutas excepto /health)
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=El sistema está en mantenimiento. Volveremos pronto.

# ============================================================================
# FEATURE FLAGS
# ============================================================================
# Habilitar registro de usuarios
ENABLE_USER_REGISTRATION=true

# Habilitar upload de archivos
ENABLE_FILE_UPLOAD=true

# Habilitar notificaciones por email
ENABLE_EMAIL_NOTIFICATIONS=false

# Habilitar autenticación de dos factores
ENABLE_2FA=false
