<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Copy/Paste Detector Report</title><link href="styles/tailwind.css" rel="stylesheet"><link href="styles/prism.css" rel="stylesheet"></head><body class="bg-gray-100"><header class="bg-white shadow py-4"><div class="container mx-auto px-4"><h1 class="text-3xl font-semibold text-gray-800">jscpd - copy/paste report</h1></div></header><main class="container mx-auto my-8 p-4 bg-white shadow rounded"><section class="mb-8" id="dashboard"><h2 class="text-2xl font-semibold text-gray-700 mb-4">Dashboard</h2><div class="grid grid-cols-4 gap-4"><div class="bg-blue-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-blue-800 mb-2">Total Files</h3><span class="text-4xl font-bold text-blue-800">858</span></div><div class="bg-green-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-green-800 mb-2">Total Lines of Code</h3><span class="text-4xl font-bold text-green-800">84217</span></div><div class="bg-yellow-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-yellow-800 mb-2">Number of Clones</h3><span class="text-4xl font-bold text-yellow-800">108</span></div><div class="bg-red-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-red-800 mb-2">Duplicated Lines</h3><span class="text-4xl font-bold text-red-800">1283 (1.52%)</span></div></div></section><section class="mb-8" id="formats"><h2 class="text-2xl font-semibold text-gray-700 mb-4">Formats with Duplications</h2><table class="w-full table-auto"><thead><tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal"><th class="py-3 px-6 text-left">Format</th><th class="py-3 px-6 text-left">Files</th><th class="py-3 px-6 text-left">Lines</th><th class="py-3 px-6 text-left">Clones</th><th class="py-3 px-6 text-left">Duplicated Lines</th><th class="py-3 px-6 text-left">Duplicated Tokens</th></tr></thead><tbody><tr class="bg-white border-b border-gray-200 text-gray-800 text-sm"><td class="py-3 px-6"><a class="text-blue-600 hover:underline" href="#typescript-clones">typescript</a></td><td class="py-3 px-6">858</td><td class="py-3 px-6">84217</td><td class="py-3 px-6">108</td><td class="py-3 px-6">1283</td><td class="py-3 px-6">8499</td></tr></tbody></table></section><section class="mb-8" id="txt-clones"><a name="typescript-clones"></a><h2 class="text-2xl font-semibold text-gray-700 mb-4">typescript</h2><div class="divide-y divide-gray-200 border-b-2"><div class="py-4"><p class="text-gray-600">apps\web\src\app\shared\components\form\input\input-field.component.ts (Line 96:7 - Line 107:2), apps\web\src\app\shared\components\form\input\text-area.component.ts (Line 65:7 - Line 77:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn0" onclick="toggleCodeBlock('cloneGroup0', 'expandBtn0', 'collapseBtn0')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn0" onclick="toggleCodeBlock('cloneGroup0', 'expandBtn0', 'collapseBtn0')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup0"><code class="language-typescript text-sm text-gray-800">) =&gt; void): void {
    this.onChange = fn;
  }

  registerOnTouched(fn: () =&gt; void): void {
    this.onTouched = fn;
  }

  setDisabledState(isDisabled: boolean): void {
    this.disabled = isDisabled;
  }
}</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\tecnicos\infrastructure\persistence\prisma-tecnico.repository.ts (Line 65:2 - Line 75:1), apps\api\src\modules\tecnicos\infrastructure\persistence\prisma-tecnico.repository.ts (Line 48:6 - Line 57:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn1" onclick="toggleCodeBlock('cloneGroup1', 'expandBtn1', 'collapseBtn1')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn1" onclick="toggleCodeBlock('cloneGroup1', 'expandBtn1', 'collapseBtn1')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup1"><code class="language-typescript text-sm text-gray-800">,
      orderBy: { name: &quot;asc&quot; },
      include: {
        asignaciones: {
          select: { estado: true },
        },
      },
    });

    return users
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\tecnicos\infrastructure\persistence\prisma-tecnico.repository.ts (Line 107:7 - Line 120:7), apps\api\src\modules\tecnicos\infrastructure\persistence\prisma-tecnico.repository.ts (Line 34:2 - Line 47:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn2" onclick="toggleCodeBlock('cloneGroup2', 'expandBtn2', 'collapseBtn2')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn2" onclick="toggleCodeBlock('cloneGroup2', 'expandBtn2', 'collapseBtn2')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup2"><code class="language-typescript text-sm text-gray-800">&gt; {
    const where: any = { role: &quot;tecnico&quot; };

    if (filters?.active !== undefined) {
      where.active = filters.active;
    }
    if (filters?.search) {
      where.OR = [
        { name: { contains: filters.search, mode: &quot;insensitive&quot; } },
        { email: { contains: filters.search, mode: &quot;insensitive&quot; } },
      ];
    }

    return</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\planeacion\application\use-cases\create-or-update-planeacion.use-case.ts (Line 37:22 - Line 51:1), apps\api\src\modules\planeacion\application\use-cases\rechazar-planeacion.use-case.ts (Line 32:23 - Line 46:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn3" onclick="toggleCodeBlock('cloneGroup3', 'expandBtn3', 'collapseBtn3')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn3" onclick="toggleCodeBlock('cloneGroup3', 'expandBtn3', 'collapseBtn3')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup3"><code class="language-typescript text-sm text-gray-800">,
      data: {
        id: planeacion.id,
        ordenId: planeacion.ordenId,
        estado: planeacion.estado,
        cronograma: planeacion.cronograma,
        manoDeObra: planeacion.manoDeObra,
        observaciones: planeacion.observaciones,
        createdAt: planeacion.createdAt.toISOString(),
        updatedAt: planeacion.updatedAt.toISOString(),
      },
    };
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\planeacion\application\use-cases\aprobar-planeacion.use-case.ts (Line 3:4 - Line 13:25), apps\api\src\modules\planeacion\application\use-cases\rechazar-planeacion.use-case.ts (Line 3:4 - Line 13:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn4" onclick="toggleCodeBlock('cloneGroup4', 'expandBtn4', 'collapseBtn4')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn4" onclick="toggleCodeBlock('cloneGroup4', 'expandBtn4', 'collapseBtn4')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup4"><code class="language-typescript text-sm text-gray-800">
import { Injectable, Inject } from &quot;@nestjs/common&quot;;
import { EventEmitter2 } from &quot;@nestjs/event-emitter&quot;;
import {
  PLANEACION_REPOSITORY,
  IPlaneacionRepository,
} from &quot;../../domain/repositories&quot;;
import { PlaneacionResponse } from &quot;../dto&quot;;

@Injectable()
export class AprobarPlaneacionUseCase</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\pdf-generation\infrastructure\services\puppeteer-pdf.service.ts (Line 78:4 - Line 89:2), apps\api\src\modules\pdf-generation\infrastructure\services\puppeteer-pdf.service.ts (Line 37:5 - Line 48:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn5" onclick="toggleCodeBlock('cloneGroup5', 'expandBtn5', 'collapseBtn5')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn5" onclick="toggleCodeBlock('cloneGroup5', 'expandBtn5', 'collapseBtn5')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup5"><code class="language-typescript text-sm text-gray-800">, {
        waitUntil: &quot;networkidle0&quot;,
      });

      const pdfOptions: puppeteer.PDFOptions = {
        format: (options?.format as any) || &quot;A4&quot;,
        landscape: options?.landscape || false,
        printBackground: options?.printBackground !== false,
        displayHeaderFooter: options?.displayHeaderFooter || false,
        headerTemplate: options?.headerTemplate || &quot;&quot;,
        footerTemplate: options?.footerTemplate || &quot;&quot;,
        margin: options?.margin,</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\pdf-generation\application\dto\generate-reporte-mantenimiento.dto.ts (Line 20:14 - Line 31:28), apps\api\src\modules\pdf-generation\application\dto\generate-reporte-orden.dto.ts (Line 20:15 - Line 31:35)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn6" onclick="toggleCodeBlock('cloneGroup6', 'expandBtn6', 'collapseBtn6')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn6" onclick="toggleCodeBlock('cloneGroup6', 'expandBtn6', 'collapseBtn6')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup6"><code class="language-typescript text-sm text-gray-800">?: boolean = true;

  @ApiPropertyOptional({
    description: &quot;Incluir detalles del técnico&quot;,
    example: true,
  })
  @IsOptional()
  @IsBoolean()
  incluirTecnico?: boolean = true;

  @ApiPropertyOptional({
    description: &quot;Incluir tareas realizadas&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ordenes\infrastructure\persistence\prisma-orden.repository.ts (Line 168:7 - Line 182:6), apps\api\src\modules\ordenes\infrastructure\persistence\prisma-orden.repository.ts (Line 151:3 - Line 165:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn7" onclick="toggleCodeBlock('cloneGroup7', 'expandBtn7', 'collapseBtn7')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn7" onclick="toggleCodeBlock('cloneGroup7', 'expandBtn7', 'collapseBtn7')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup7"><code class="language-typescript text-sm text-gray-800">, deletedAt: null },
      include: {
        creador: { select: { id: true, name: true } },
        asignado: { select: { id: true, name: true } },
      },
    });

    if (!order) return null;

    return this.toDomainEntity(order);
  }

  /**
   * Crea una nueva orden
   */</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ordenes\infrastructure\persistence\prisma-orden.repository.ts (Line 251:11 - Line 263:6), apps\api\src\modules\ordenes\infrastructure\persistence\prisma-orden.repository.ts (Line 151:2 - Line 234:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn8" onclick="toggleCodeBlock('cloneGroup8', 'expandBtn8', 'collapseBtn8')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn8" onclick="toggleCodeBlock('cloneGroup8', 'expandBtn8', 'collapseBtn8')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup8"><code class="language-typescript text-sm text-gray-800">,
      include: {
        creador: { select: { id: true, name: true } },
        asignado: { select: { id: true, name: true } },
      },
    });

    return this.toDomainEntity(updated);
  }

  /**
   * Elimina una orden
   */</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kpis\application\use-cases\get-ordenes-kpis.use-case.ts (Line 110:2 - Line 120:23), apps\api\src\modules\kpis\application\use-cases\get-ordenes-kpis.use-case.ts (Line 92:2 - Line 102:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn9" onclick="toggleCodeBlock('cloneGroup9', 'expandBtn9', 'collapseBtn9')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn9" onclick="toggleCodeBlock('cloneGroup9', 'expandBtn9', 'collapseBtn9')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup9"><code class="language-typescript text-sm text-gray-800">
        createdAt: {
          gte: fechaInicio,
          lte: fechaFin,
        },
        ...(clienteId &amp;&amp; { clienteId }),
      },
    });
  }

  private async calcularTiempoPromedio</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kpis\application\use-cases\get-financial-kpis.use-case.ts (Line 74:2 - Line 84:13), apps\api\src\modules\kpis\application\use-cases\get-ordenes-kpis.use-case.ts (Line 83:2 - Line 110:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn10" onclick="toggleCodeBlock('cloneGroup10', 'expandBtn10', 'collapseBtn10')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn10" onclick="toggleCodeBlock('cloneGroup10', 'expandBtn10', 'collapseBtn10')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup10"><code class="language-typescript text-sm text-gray-800">
  }

  private async contarOrdenes(
    fechaInicio: Date,
    fechaFin: Date,
    clienteId?: string,
  ): Promise&lt;number&gt; {
    return this.prisma.order.count({
      where: {
        estado: &quot;completada&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\infrastructure\persistence\kit.repository.impl.ts (Line 38:2 - Line 48:9), apps\api\src\modules\kits\infrastructure\persistence\kit.repository.impl.ts (Line 27:2 - Line 37:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn11" onclick="toggleCodeBlock('cloneGroup11', 'expandBtn11', 'collapseBtn11')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn11" onclick="toggleCodeBlock('cloneGroup11', 'expandBtn11', 'collapseBtn11')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup11"><code class="language-typescript text-sm text-gray-800">
        nombre: data[&quot;nombre&quot;] as string,
        descripcion: (data[&quot;descripcion&quot;] as string | undefined) ?? &quot;&quot;,
        herramientas: data[&quot;herramientas&quot;] as object,
        equipos: data[&quot;equipos&quot;] as object,
        documentos: data[&quot;documentos&quot;] as string[],
        checklistItems: data[&quot;checklistItems&quot;] as string[],
        duracionEstimadaHoras: data[&quot;duracionEstimadaHoras&quot;] as number,
        costoEstimado: data[&quot;costoEstimado&quot;] as number,
        activo: data[&quot;activo&quot;] as boolean,
        </code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\infrastructure\persistence\kit.repository.impl.ts (Line 120:2 - Line 130:15), apps\api\src\modules\kits\infrastructure\persistence\kit.repository.impl.ts (Line 81:2 - Line 91:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn12" onclick="toggleCodeBlock('cloneGroup12', 'expandBtn12', 'collapseBtn12')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn12" onclick="toggleCodeBlock('cloneGroup12', 'expandBtn12', 'collapseBtn12')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup12"><code class="language-typescript text-sm text-gray-800"> },
      },
      orderBy: { createdAt: &quot;desc&quot; },
    });

    return kits.map((k) =&gt;
      KitMapper.fromPrisma(k as unknown as Record&lt;string, unknown&gt;),
    );
  }

  async existsByCodigo</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\domain\events\kit.events.ts (Line 47:20 - Line 61:17), apps\api\src\modules\kits\domain\events\kit.events.ts (Line 33:18 - Line 47:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn13" onclick="toggleCodeBlock('cloneGroup13', 'expandBtn13', 'collapseBtn13')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn13" onclick="toggleCodeBlock('cloneGroup13', 'expandBtn13', 'collapseBtn13')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup13"><code class="language-typescript text-sm text-gray-800"> {
  public readonly occurredOn: Date;

  constructor(
    public readonly payload: {
      kitId: string;
      itemId: string;
      itemNombre: string;
    },
  ) {
    this.occurredOn = new Date();
  }
}

export class KitAssignedEvent</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\domain\events\kit.events.ts (Line 102:20 - Line 113:1), apps\api\src\modules\kits\domain\events\kit.events.ts (Line 90:18 - Line 101:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn14" onclick="toggleCodeBlock('cloneGroup14', 'expandBtn14', 'collapseBtn14')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn14" onclick="toggleCodeBlock('cloneGroup14', 'expandBtn14', 'collapseBtn14')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup14"><code class="language-typescript text-sm text-gray-800"> {
  public readonly occurredOn: Date;

  constructor(
    public readonly payload: {
      kitId: string;
    },
  ) {
    this.occurredOn = new Date();
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\domain\entities\kit-item.entity.ts (Line 161:10 - Line 172:12), apps\api\src\modules\kits\domain\entities\kit.entity.ts (Line 384:8 - Line 395:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn15" onclick="toggleCodeBlock('cloneGroup15', 'expandBtn15', 'collapseBtn15')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn15" onclick="toggleCodeBlock('cloneGroup15', 'expandBtn15', 'collapseBtn15')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup15"><code class="language-typescript text-sm text-gray-800">;
  }

  public getNombre(): string {
    return this._nombre;
  }

  public getDescripcion(): string | undefined {
    return this._descripcion;
  }

  public getCantidad</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\hes\infrastructure\persistence\hes.repository.ts (Line 85:7 - Line 95:12), apps\api\src\modules\hes\infrastructure\persistence\hes.repository.ts (Line 73:3 - Line 83:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn16" onclick="toggleCodeBlock('cloneGroup16', 'expandBtn16', 'collapseBtn16')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn16" onclick="toggleCodeBlock('cloneGroup16', 'expandBtn16', 'collapseBtn16')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup16"><code class="language-typescript text-sm text-gray-800">.getValue() },
    });

    if (!data) {
      return null;
    }

    return HESPrismaMapper.fromPrisma(data);
  }

  async findByOrden</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\hes\application\use-cases\complete-hes.use-case.ts (Line 26:14 - Line 37:23), apps\api\src\modules\hes\application\use-cases\get-hes.use-case.ts (Line 16:15 - Line 27:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn17" onclick="toggleCodeBlock('cloneGroup17', 'expandBtn17', 'collapseBtn17')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn17" onclick="toggleCodeBlock('cloneGroup17', 'expandBtn17', 'collapseBtn17')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup17"><code class="language-typescript text-sm text-gray-800">,
  ) {}

  async execute(hesId: string): Promise&lt;HES&gt; {
    const id = HESId.create(hesId);
    const hes = await this.repository.findById(id);

    if (!hes) {
      throw new NotFoundException(`HES no encontrada: ${hesId}`);
    }

    // Validar completitud</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\hes\application\use-cases\complete-hes.use-case.ts (Line 58:20 - Line 68:1), apps\api\src\modules\hes\application\use-cases\create-hes.use-case.ts (Line 51:31 - Line 61:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn18" onclick="toggleCodeBlock('cloneGroup18', 'expandBtn18', 'collapseBtn18')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn18" onclick="toggleCodeBlock('cloneGroup18', 'expandBtn18', 'collapseBtn18')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup18"><code class="language-typescript text-sm text-gray-800">
    const domainEvents = saved.getDomainEvents();
    for (const event of domainEvents) {
      this.eventEmitter.emit(event.constructor.name, event);
    }
    saved.clearDomainEvents();

    return saved;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\hes\application\mappers\hes.mapper.ts (Line 25:15 - Line 37:19), apps\api\src\modules\hes\infrastructure\persistence\hes.prisma.mapper.ts (Line 33:4 - Line 45:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn19" onclick="toggleCodeBlock('cloneGroup19', 'expandBtn19', 'collapseBtn19')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn19" onclick="toggleCodeBlock('cloneGroup19', 'expandBtn19', 'collapseBtn19')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup19"><code class="language-typescript text-sm text-gray-800"> {
    const {
      clienteInfo,
      condicionesEntrada,
      diagnosticoPreliminar: diagnostico,
      requerimientosSeguridad: seguridad,
      firmaCliente,
      firmaTecnico,
    } = getHesParts(hes);

    return {
      ...mapHesCore(hes),
      clienteInfo: mapClienteInfoCore</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\hes\application\dto\create-hes.dto.ts (Line 44:2 - Line 54:1), apps\api\src\modules\hes\domain\entities\cliente-info.entity.ts (Line 18:10 - Line 27:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn20" onclick="toggleCodeBlock('cloneGroup20', 'expandBtn20', 'collapseBtn20')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn20" onclick="toggleCodeBlock('cloneGroup20', 'expandBtn20', 'collapseBtn20')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup20"><code class="language-typescript text-sm text-gray-800">: {
    calle: string;
    numero?: string;
    barrio?: string;
    ciudad: string;
    departamento?: string;
    pais?: string;
    codigoPostal?: string;
  };

</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\formularios\infrastructure\persistence\form-submission.repository.ts (Line 87:10 - Line 98:17), apps\api\src\modules\formularios\infrastructure\persistence\form-submission.repository.ts (Line 68:2 - Line 79:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn21" onclick="toggleCodeBlock('cloneGroup21', 'expandBtn21', 'collapseBtn21')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn21" onclick="toggleCodeBlock('cloneGroup21', 'expandBtn21', 'collapseBtn21')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup21"><code class="language-typescript text-sm text-gray-800">,
      },
      orderBy: { createdAt: &quot;desc&quot; },
      include: {
        template: true,
      },
    });

    return submissions.map((s) =&gt; this.fromPrisma(s));
  }

  async countSubmissions</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\formularios\infrastructure\persistence\form-submission.repository.ts (Line 107:2 - Line 117:7), apps\api\src\modules\formularios\infrastructure\persistence\form-submission.repository.ts (Line 69:2 - Line 79:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn22" onclick="toggleCodeBlock('cloneGroup22', 'expandBtn22', 'collapseBtn22')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn22" onclick="toggleCodeBlock('cloneGroup22', 'expandBtn22', 'collapseBtn22')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup22"><code class="language-typescript text-sm text-gray-800">
      orderBy: { createdAt: &quot;desc&quot; },
      include: {
        template: true,
      },
    });

    return submissions.map((s) =&gt; this.fromPrisma(s));
  }

  async delete</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\formularios\domain\entities\form-template.entity.ts (Line 196:2 - Line 208:36), apps\api\src\modules\formularios\domain\entities\form-template.entity.ts (Line 176:7 - Line 188:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn23" onclick="toggleCodeBlock('cloneGroup23', 'expandBtn23', 'collapseBtn23')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn23" onclick="toggleCodeBlock('cloneGroup23', 'expandBtn23', 'collapseBtn23')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup23"><code class="language-typescript text-sm text-gray-800">): void {
    if (!this.canEdit()) {
      throw new BusinessRuleViolationError(&quot;Cannot edit published template&quot;);
    }

    const field = this.findField(fieldId);
    if (!field) {
      throw new BusinessRuleViolationError(
        `Field with id ${fieldId} not found`,
      );
    }

    // Actualizar campo (inmutabilidad)</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\formularios\application\use-cases\get-template.use-case.ts (Line 5:4 - Line 15:1), apps\api\src\modules\formularios\application\use-cases\update-template.use-case.ts (Line 5:4 - Line 14:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn24" onclick="toggleCodeBlock('cloneGroup24', 'expandBtn24', 'collapseBtn24')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn24" onclick="toggleCodeBlock('cloneGroup24', 'expandBtn24', 'collapseBtn24')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup24"><code class="language-typescript text-sm text-gray-800">

import { Injectable, NotFoundException, Inject } from &quot;@nestjs/common&quot;;
import { FormTemplate } from &quot;../../domain/entities/form-template.entity&quot;;
import { FormTemplateId } from &quot;../../domain/value-objects/form-template-id.vo&quot;;
import {
  IFormTemplateRepository,
  FORM_TEMPLATE_REPOSITORY,
} from &quot;../../domain/repositories&quot;;

</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\evidencias\infrastructure\controllers\evidencias.controller.ts (Line 164:2 - Line 177:6), apps\api\src\modules\evidencias\infrastructure\controllers\evidencias.controller.ts (Line 129:5 - Line 142:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn25" onclick="toggleCodeBlock('cloneGroup25', 'expandBtn25', 'collapseBtn25')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn25" onclick="toggleCodeBlock('cloneGroup25', 'expandBtn25', 'collapseBtn25')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup25"><code class="language-typescript text-sm text-gray-800">});

    res.setHeader(&quot;Content-Type&quot;, mimeType);
    res.setHeader(
      &quot;Content-Disposition&quot;,
      `attachment; filename*=UTF-8''${encodeURIComponent(filename)}`,
    );

    return new StreamableFile(buffer);
  }

  /**
   * Get single evidencia by ID
   */</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\evidencias\application\use-cases\download-evidencia.use-case.ts (Line 13:17 - Line 27:1), apps\api\src\modules\evidencias\application\use-cases\upload-evidencia.use-case.ts (Line 16:24 - Line 29:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn26" onclick="toggleCodeBlock('cloneGroup26', 'expandBtn26', 'collapseBtn26')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn26" onclick="toggleCodeBlock('cloneGroup26', 'expandBtn26', 'collapseBtn26')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup26"><code class="language-typescript text-sm text-gray-800">;
import {
  IEvidenciaRepository,
  EVIDENCIA_REPOSITORY,
} from &quot;../../domain/repositories&quot;;
import {
  IStorageProvider,
  STORAGE_PROVIDER,
} from &quot;../../infrastructure/storage/storage-provider.interface&quot;;
import {
  ORDEN_REPOSITORY,
  IOrdenRepository,
} from &quot;../../../ordenes/domain/repositories&quot;;

</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\evidencias\application\use-cases\download-evidencia.use-case.ts (Line 77:98 - Line 89:12), apps\api\src\modules\evidencias\application\use-cases\generate-evidencia-download-token.use-case.ts (Line 60:1 - Line 72:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn27" onclick="toggleCodeBlock('cloneGroup27', 'expandBtn27', 'collapseBtn27')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn27" onclick="toggleCodeBlock('cloneGroup27', 'expandBtn27', 'collapseBtn27')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup27"><code class="language-typescript text-sm text-gray-800">
    const role = requesterRole?.toLowerCase();
    const isPrivileged = role === &quot;admin&quot; || role === &quot;supervisor&quot;;
    const canAccess =
      isPrivileged ||
      evidencia.uploadedBy === requestedBy ||
      orden.creadorId === requestedBy ||
      orden.asignadoId === requestedBy;
    if (!canAccess) {
      throw new ForbiddenException(&quot;No autorizado&quot;);
    }

    const storagePath</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\infrastructure\persistence\ejecucion.repository.ts (Line 91:8 - Line 104:7), apps\api\src\modules\ejecucion\infrastructure\persistence\ejecucion.repository.ts (Line 76:2 - Line 89:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn28" onclick="toggleCodeBlock('cloneGroup28', 'expandBtn28', 'collapseBtn28')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn28" onclick="toggleCodeBlock('cloneGroup28', 'expandBtn28', 'collapseBtn28')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup28"><code class="language-typescript text-sm text-gray-800"> },
      include: {
        tareas: true,
        checklists: true,
        evidenciasEjecucion: true,
        fotosEvidencia: true,
      },
    });

    if (!ejecucion) return null;
    return this.mapToDomain(ejecucion);
  }

  async exists</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\infrastructure\persistence\ejecucion.repository.ts (Line 139:6 - Line 150:86), apps\api\src\modules\ejecucion\infrastructure\persistence\ejecucion.repository.ts (Line 115:2 - Line 126:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn29" onclick="toggleCodeBlock('cloneGroup29', 'expandBtn29', 'collapseBtn29')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn29" onclick="toggleCodeBlock('cloneGroup29', 'expandBtn29', 'collapseBtn29')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup29"><code class="language-typescript text-sm text-gray-800">,
      include: {
        tareas: true,
        checklists: true,
        evidenciasEjecucion: true,
      },
    });

    return executions.map((e) =&gt; this.mapToDomain(e));
  }

  // ========== TIME LOGS (Stored in memory for now, future: separate table) ==========</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\domain\entities\evidence.entity.ts (Line 67:2 - Line 78:8), apps\api\src\modules\ejecucion\domain\entities\time-log.entity.ts (Line 40:6 - Line 51:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn30" onclick="toggleCodeBlock('cloneGroup30', 'expandBtn30', 'collapseBtn30')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn30" onclick="toggleCodeBlock('cloneGroup30', 'expandBtn30', 'collapseBtn30')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup30"><code class="language-typescript text-sm text-gray-800">);
  }

  public getId(): string {
    return this.id;
  }

  public getEjecucionId(): string {
    return this.ejecucionId;
  }

  public getType</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\domain\entities\ejecucion.entity.ts (Line 429:2 - Line 440:1), apps\api\src\modules\ejecucion\domain\entities\ejecucion.entity.ts (Line 262:2 - Line 272:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn31" onclick="toggleCodeBlock('cloneGroup31', 'expandBtn31', 'collapseBtn31')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn31" onclick="toggleCodeBlock('cloneGroup31', 'expandBtn31', 'collapseBtn31')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup31"><code class="language-typescript text-sm text-gray-800">
    this.updatedAt = new Date();

    // Stop active time log
    const activeLog = this.getActiveTimeLog();
    if (activeLog) {
      activeLog.stop();
    }

    // Create activity log
    this.addActivityLog(
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\domain\entities\activity-log.entity.ts (Line 54:9 - Line 67:16), apps\api\src\modules\ejecucion\domain\entities\evidence.entity.ts (Line 65:17 - Line 51:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn32" onclick="toggleCodeBlock('cloneGroup32', 'expandBtn32', 'collapseBtn32')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn32" onclick="toggleCodeBlock('cloneGroup32', 'expandBtn32', 'collapseBtn32')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup32"><code class="language-typescript text-sm text-gray-800">)
        : undefined,
    });
  }

  public getId(): string {
    return this.id;
  }

  public getEjecucionId(): string {
    return this.ejecucionId;
  }

  public getActivityType</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\application\use-cases\iniciar-ejecucion.use-case.ts (Line 4:4 - Line 16:10), apps\api\src\modules\ejecucion\application\use-cases\update-avance.use-case.ts (Line 4:4 - Line 16:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn33" onclick="toggleCodeBlock('cloneGroup33', 'expandBtn33', 'collapseBtn33')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn33" onclick="toggleCodeBlock('cloneGroup33', 'expandBtn33', 'collapseBtn33')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup33"><code class="language-typescript text-sm text-gray-800">
import {
  Injectable,
  Inject,
  NotFoundException,
  BadRequestException,
} from &quot;@nestjs/common&quot;;
import { EventEmitter2 } from &quot;@nestjs/event-emitter&quot;;
import {
  EJECUCION_REPOSITORY,
  IEjecucionRepository,
} from &quot;../../domain/repositories&quot;;
import { Ejecucion</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\application\use-cases\completar-ejecucion.use-case.ts (Line 4:4 - Line 17:2), apps\api\src\modules\ejecucion\application\use-cases\update-avance.use-case.ts (Line 4:4 - Line 17:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn34" onclick="toggleCodeBlock('cloneGroup34', 'expandBtn34', 'collapseBtn34')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn34" onclick="toggleCodeBlock('cloneGroup34', 'expandBtn34', 'collapseBtn34')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup34"><code class="language-typescript text-sm text-gray-800">
import {
  Injectable,
  Inject,
  NotFoundException,
  BadRequestException,
} from &quot;@nestjs/common&quot;;
import { EventEmitter2 } from &quot;@nestjs/event-emitter&quot;;
import {
  EJECUCION_REPOSITORY,
  IEjecucionRepository,
} from &quot;../../domain/repositories&quot;;
import { EjecucionId, ProgressPercentage } from &quot;../../domain/value-objects&quot;;
import { EjecucionResponse,</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\dashboard\domain\value-objects\comparison-result.vo.ts (Line 113:2 - Line 125:1), apps\api\src\modules\dashboard\domain\value-objects\kpi-value.vo.ts (Line 240:10 - Line 252:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn35" onclick="toggleCodeBlock('cloneGroup35', 'expandBtn35', 'collapseBtn35')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn35" onclick="toggleCodeBlock('cloneGroup35', 'expandBtn35', 'collapseBtn35')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup35"><code class="language-typescript text-sm text-gray-800">,
      formatted: this.format(),
    };
  }

  /**
   * Representación string
   */
  public toString(): string {
    return this.format();
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\infrastructure\controllers\costos.controller.ts (Line 17:8 - Line 27:18), apps\api\src\modules\reportes\infrastructure\controllers\reportes.controller.ts (Line 13:14 - Line 23:30)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn36" onclick="toggleCodeBlock('cloneGroup36', 'expandBtn36', 'collapseBtn36')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn36" onclick="toggleCodeBlock('cloneGroup36', 'expandBtn36', 'collapseBtn36')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup36"><code class="language-typescript text-sm text-gray-800">,
  ApiOperation,
  ApiParam,
  ApiResponse,
  ApiTags,
} from &quot;@nestjs/swagger&quot;;
import { JwtAuthGuard } from &quot;../../../auth/guards/jwt-auth.guard&quot;;
import { RolesGuard } from &quot;../../../auth/guards/roles.guard&quot;;
import { Roles } from &quot;../../../auth/decorators/roles.decorator&quot;;
import {
  ListCostosUseCase</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\value-objects\costo-id.vo.ts (Line 38:8 - Line 52:1), apps\api\src\modules\costos\domain\value-objects\costo-type.vo.ts (Line 82:10 - Line 96:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn37" onclick="toggleCodeBlock('cloneGroup37', 'expandBtn37', 'collapseBtn37')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn37" onclick="toggleCodeBlock('cloneGroup37', 'expandBtn37', 'collapseBtn37')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup37"><code class="language-typescript text-sm text-gray-800">)) {
      return false;
    }
    return this._value === other._value;
  }

  public toString(): string {
    return this._value;
  }

  public toJSON(): string {
    return this._value;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\value-objects\costo-category.vo.ts (Line 57:14 - Line 71:1), apps\api\src\modules\costos\domain\value-objects\costo-type.vo.ts (Line 82:10 - Line 96:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn38" onclick="toggleCodeBlock('cloneGroup38', 'expandBtn38', 'collapseBtn38')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn38" onclick="toggleCodeBlock('cloneGroup38', 'expandBtn38', 'collapseBtn38')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup38"><code class="language-typescript text-sm text-gray-800">)) {
      return false;
    }
    return this._value === other._value;
  }

  public toString(): string {
    return this._value;
  }

  public toJSON(): string {
    return this._value;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\value-objects\budget-limit.vo.ts (Line 5:4 - Line 18:12), apps\api\src\modules\costos\domain\value-objects\cost-variance.vo.ts (Line 5:4 - Line 18:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn39" onclick="toggleCodeBlock('cloneGroup39', 'expandBtn39', 'collapseBtn39')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn39" onclick="toggleCodeBlock('cloneGroup39', 'expandBtn39', 'collapseBtn39')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup39"><code class="language-typescript text-sm text-gray-800">

// Decimal.js es open source
let Decimal: any;
try {
  Decimal = require(&quot;decimal.js&quot;);
} catch (error) {
  // Fallback
}

import { Money } from &quot;./money.vo&quot;;
import { ValidationError } from &quot;../exceptions&quot;;

export class BudgetLimit</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\events\cost-updated.event.ts (Line 31:7 - Line 41:10), apps\api\src\modules\costos\domain\events\costo-registered.event.ts (Line 31:13 - Line 41:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn40" onclick="toggleCodeBlock('cloneGroup40', 'expandBtn40', 'collapseBtn40')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn40" onclick="toggleCodeBlock('cloneGroup40', 'expandBtn40', 'collapseBtn40')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup40"><code class="language-typescript text-sm text-gray-800">;
    this.timestamp = props.timestamp;
    Object.freeze(this);
  }

  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      ordenId: this.ordenId,
      oldAmount</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\events\cost-deleted.event.ts (Line 27:10 - Line 39:10), apps\api\src\modules\costos\domain\events\cost-updated.event.ts (Line 30:10 - Line 42:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn41" onclick="toggleCodeBlock('cloneGroup41', 'expandBtn41', 'collapseBtn41')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn41" onclick="toggleCodeBlock('cloneGroup41', 'expandBtn41', 'collapseBtn41')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup41"><code class="language-typescript text-sm text-gray-800">;
    this.reason = props.reason;
    this.timestamp = props.timestamp;
    Object.freeze(this);
  }

  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      ordenId: this.ordenId,
      amount: this.amount,
      deletedBy</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\events\budget-exceeded.event.ts (Line 30:13 - Line 40:8), apps\api\src\modules\costos\domain\events\costo-registered.event.ts (Line 31:13 - Line 41:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn42" onclick="toggleCodeBlock('cloneGroup42', 'expandBtn42', 'collapseBtn42')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn42" onclick="toggleCodeBlock('cloneGroup42', 'expandBtn42', 'collapseBtn42')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup42"><code class="language-typescript text-sm text-gray-800">;
    this.timestamp = props.timestamp;
    Object.freeze(this);
  }

  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      ordenId: this.ordenId,
      costoId</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\costos\domain\events\budget-alert-triggered.event.ts (Line 24:10 - Line 34:22), apps\api\src\modules\costos\domain\events\costo-registered.event.ts (Line 31:13 - Line 41:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn43" onclick="toggleCodeBlock('cloneGroup43', 'expandBtn43', 'collapseBtn43')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn43" onclick="toggleCodeBlock('cloneGroup43', 'expandBtn43', 'collapseBtn43')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup43"><code class="language-typescript text-sm text-gray-800">;
    this.timestamp = props.timestamp;
    Object.freeze(this);
  }

  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      ordenId: this.ordenId,
      utilizationPercentage</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\cierre-administrativo\infrastructure\controllers\cierre-administrativo.controller.ts (Line 12:4 - Line 27:24), apps\api\src\modules\costos\infrastructure\controllers\costos.controller.ts (Line 12:10 - Line 23:30)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn44" onclick="toggleCodeBlock('cloneGroup44', 'expandBtn44', 'collapseBtn44')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn44" onclick="toggleCodeBlock('cloneGroup44', 'expandBtn44', 'collapseBtn44')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup44"><code class="language-typescript text-sm text-gray-800">,
  BadRequestException,
} from &quot;@nestjs/common&quot;;
import {
  ApiBearerAuth,
  ApiBody,
  ApiOperation,
  ApiParam,
  ApiResponse,
  ApiTags,
} from &quot;@nestjs/swagger&quot;;
import { JwtAuthGuard } from &quot;../../../auth/guards/jwt-auth.guard&quot;;
import { RolesGuard } from &quot;../../../auth/guards/roles.guard&quot;;
import { Roles } from &quot;../../../auth/decorators/roles.decorator&quot;;
import {
  GetCierreByOrdenUseCase</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\cierre-administrativo\domain\value-objects\cierre-id.vo.ts (Line 34:9 - Line 45:1), apps\api\src\modules\cierre-administrativo\domain\value-objects\cierre-status.vo.ts (Line 72:13 - Line 83:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn45" onclick="toggleCodeBlock('cloneGroup45', 'expandBtn45', 'collapseBtn45')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn45" onclick="toggleCodeBlock('cloneGroup45', 'expandBtn45', 'collapseBtn45')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup45"><code class="language-typescript text-sm text-gray-800"> &amp;&amp; this.value === other.value;
  }

  toString(): string {
    return this.value;
  }

  toJSON(): string {
    return this.value;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\cierre-administrativo\domain\events\cierre-created.event.ts (Line 11:7 - Line 22:10), apps\api\src\modules\cierre-administrativo\domain\events\cierre-rejected.event.ts (Line 12:2 - Line 23:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn46" onclick="toggleCodeBlock('cloneGroup46', 'expandBtn46', 'collapseBtn46')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn46" onclick="toggleCodeBlock('cloneGroup46', 'expandBtn46', 'collapseBtn46')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup46"><code class="language-typescript text-sm text-gray-800">,
  ) {
    this.occurredAt = new Date();
    Object.freeze(this);
  }

  toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      cierreId: this.cierreId,
      ordenId: this.ordenId,
      createdBy</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\cierre-administrativo\domain\events\cierre-approved.event.ts (Line 12:7 - Line 23:11), apps\api\src\modules\cierre-administrativo\domain\events\cierre-rejected.event.ts (Line 12:7 - Line 23:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn47" onclick="toggleCodeBlock('cloneGroup47', 'expandBtn47', 'collapseBtn47')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn47" onclick="toggleCodeBlock('cloneGroup47', 'expandBtn47', 'collapseBtn47')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup47"><code class="language-typescript text-sm text-gray-800">&gt;,
  ) {
    this.occurredAt = new Date();
    Object.freeze(this);
  }

  toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      cierreId: this.cierreId,
      ordenId: this.ordenId,
      approvedBy</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\infrastructure\persistence\checklist.repository.ts (Line 157:2 - Line 167:3), apps\api\src\modules\checklists\infrastructure\persistence\checklist.repository.ts (Line 131:7 - Line 141:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn48" onclick="toggleCodeBlock('cloneGroup48', 'expandBtn48', 'collapseBtn48')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn48" onclick="toggleCodeBlock('cloneGroup48', 'expandBtn48', 'collapseBtn48')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup48"><code class="language-typescript text-sm text-gray-800">},
      include: {
        items: {
          include: { templateItem: true },
          orderBy: { createdAt: &quot;asc&quot; },
        },
        template: true,
      },
    });

    if</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\infrastructure\persistence\checklist.repository.ts (Line 187:2 - Line 199:2), apps\api\src\modules\checklists\infrastructure\persistence\checklist.repository.ts (Line 155:44 - Line 167:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn49" onclick="toggleCodeBlock('cloneGroup49', 'expandBtn49', 'collapseBtn49')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn49" onclick="toggleCodeBlock('cloneGroup49', 'expandBtn49', 'collapseBtn49')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup49"><code class="language-typescript text-sm text-gray-800">
    const ejecucion = await this.prisma.checklistEjecucion.findUnique({
      where: { id },
      include: {
        items: {
          include: { templateItem: true },
          orderBy: { createdAt: &quot;asc&quot; },
        },
        template: true,
      },
    });

    if (!</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\infrastructure\persistence\checklist.repository.ts (Line 356:12 - Line 370:15), apps\api\src\modules\checklists\infrastructure\persistence\checklist.repository.ts (Line 157:3 - Line 354:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn50" onclick="toggleCodeBlock('cloneGroup50', 'expandBtn50', 'collapseBtn50')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn50" onclick="toggleCodeBlock('cloneGroup50', 'expandBtn50', 'collapseBtn50')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup50"><code class="language-typescript text-sm text-gray-800"> },
      include: {
        items: {
          include: { templateItem: true },
          orderBy: { createdAt: &quot;asc&quot; },
        },
        template: true,
      },
      orderBy: { createdAt: &quot;desc&quot; },
    });

    return checklists.map((c) =&gt; ChecklistPrismaMapper.ejecucionToDomain(c));
  }

  async existsAssigned</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\infrastructure\controllers\checklists.controller.ts (Line 15:24 - Line 25:23), apps\api\src\modules\hes\infrastructure\controllers\hes.controller.ts (Line 26:9 - Line 26:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn51" onclick="toggleCodeBlock('cloneGroup51', 'expandBtn51', 'collapseBtn51')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn51" onclick="toggleCodeBlock('cloneGroup51', 'expandBtn51', 'collapseBtn51')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup51"><code class="language-typescript text-sm text-gray-800">,
} from &quot;@nestjs/swagger&quot;;
import { JwtAuthGuard } from &quot;../../../../common/guards/jwt-auth.guard&quot;;
import { RolesGuard } from &quot;../../../../common/guards/roles.guard&quot;;
import { Roles } from &quot;../../../../common/decorators/roles.decorator&quot;;
import {
  CurrentUser,
  JwtPayload,
} from &quot;../../../../common/decorators/current-user.decorator&quot;;
import {
  CreateChecklistUseCase</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\domain\value-objects\checklist-status.vo.ts (Line 137:16 - Line 151:1), apps\api\src\modules\costos\domain\value-objects\costo-type.vo.ts (Line 82:10 - Line 96:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn52" onclick="toggleCodeBlock('cloneGroup52', 'expandBtn52', 'collapseBtn52')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn52" onclick="toggleCodeBlock('cloneGroup52', 'expandBtn52', 'collapseBtn52')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup52"><code class="language-typescript text-sm text-gray-800">)) {
      return false;
    }
    return this._value === other._value;
  }

  public toString(): string {
    return this._value;
  }

  public toJSON(): string {
    return this._value;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\domain\value-objects\checklist-item-id.vo.ts (Line 38:16 - Line 52:1), apps\api\src\modules\costos\domain\value-objects\costo-type.vo.ts (Line 82:10 - Line 96:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn53" onclick="toggleCodeBlock('cloneGroup53', 'expandBtn53', 'collapseBtn53')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn53" onclick="toggleCodeBlock('cloneGroup53', 'expandBtn53', 'collapseBtn53')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup53"><code class="language-typescript text-sm text-gray-800">)) {
      return false;
    }
    return this._value === other._value;
  }

  public toString(): string {
    return this._value;
  }

  public toJSON(): string {
    return this._value;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\domain\value-objects\checklist-id.vo.ts (Line 38:12 - Line 52:1), apps\api\src\modules\costos\domain\value-objects\costo-type.vo.ts (Line 82:10 - Line 96:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn54" onclick="toggleCodeBlock('cloneGroup54', 'expandBtn54', 'collapseBtn54')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn54" onclick="toggleCodeBlock('cloneGroup54', 'expandBtn54', 'collapseBtn54')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup54"><code class="language-typescript text-sm text-gray-800">)) {
      return false;
    }
    return this._value === other._value;
  }

  public toString(): string {
    return this._value;
  }

  public toJSON(): string {
    return this._value;
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\domain\events\checklist-completed.event.ts (Line 25:12 - Line 35:12), apps\api\src\modules\costos\domain\events\costo-registered.event.ts (Line 31:13 - Line 41:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn55" onclick="toggleCodeBlock('cloneGroup55', 'expandBtn55', 'collapseBtn55')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn55" onclick="toggleCodeBlock('cloneGroup55', 'expandBtn55', 'collapseBtn55')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup55"><code class="language-typescript text-sm text-gray-800">;
    this.timestamp = props.timestamp;
    Object.freeze(this);
  }

  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      ordenId: this.ordenId,
      ejecucionId</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\domain\entities\checklist.entity.ts (Line 603:14 - Line 614:67), apps\api\src\modules\formularios\domain\entities\form-submission.entity.ts (Line 326:13 - Line 337:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn56" onclick="toggleCodeBlock('cloneGroup56', 'expandBtn56', 'collapseBtn56')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn56" onclick="toggleCodeBlock('cloneGroup56', 'expandBtn56', 'collapseBtn56')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup56"><code class="language-typescript text-sm text-gray-800">;
  }

  public getCreatedAt(): Date {
    return this._createdAt;
  }

  public getUpdatedAt(): Date {
    return this._updatedAt;
  }

  // ═══════════════════════════════════════════════════════════════</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\domain\entities\checklist.entity.ts (Line 624:10 - Line 634:2), apps\api\src\modules\checklists\domain\entities\checklist.entity.ts (Line 218:2 - Line 228:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn57" onclick="toggleCodeBlock('cloneGroup57', 'expandBtn57', 'collapseBtn57')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn57" onclick="toggleCodeBlock('cloneGroup57', 'expandBtn57', 'collapseBtn57')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup57"><code class="language-typescript text-sm text-gray-800">: string | null;
    items: Array&lt;{
      id: string;
      label: string;
      isRequired: boolean;
      isChecked: boolean;
      checkedAt?: Date;
      observaciones?: string;
      orden: number;
    }&gt;;
    ordenId:</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\application\use-cases\toggle-checklist-item.use-case.ts (Line 45:26 - Line 56:44), apps\api\src\modules\checklists\application\use-cases\update-checklist-item.use-case.ts (Line 33:33 - Line 44:31)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn58" onclick="toggleCodeBlock('cloneGroup58', 'expandBtn58', 'collapseBtn58')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn58" onclick="toggleCodeBlock('cloneGroup58', 'expandBtn58', 'collapseBtn58')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup58"><code class="language-typescript text-sm text-gray-800">, context);

    try {
      // 1. Buscar checklist
      const checklist = await this.repository.findInstanceById(dto.checklistId);
      if (!checklist) {
        throw new NotFoundException(
          `Checklist ${dto.checklistId} no encontrado`,
        );
      }

      // 2. Validar pertenencia a orden/ejecución</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\application\use-cases\get-checklists-by-ejecucion.use-case.ts (Line 5:4 - Line 16:32), apps\api\src\modules\checklists\application\use-cases\get-checklists-by-orden.use-case.ts (Line 5:4 - Line 16:28)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn59" onclick="toggleCodeBlock('cloneGroup59', 'expandBtn59', 'collapseBtn59')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn59" onclick="toggleCodeBlock('cloneGroup59', 'expandBtn59', 'collapseBtn59')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup59"><code class="language-typescript text-sm text-gray-800">

import { Injectable, Inject, Logger } from &quot;@nestjs/common&quot;;
import {
  IChecklistRepository,
  CHECKLIST_REPOSITORY,
} from &quot;../../domain/repositories&quot;;
import { ChecklistResponseDto } from &quot;../dto/checklist-response.dto&quot;;
import { ChecklistMapper } from &quot;../mappers/checklist.mapper&quot;;

@Injectable()
export class GetChecklistsByEjecucionUseCase</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\application\use-cases\complete-checklist.use-case.ts (Line 37:24 - Line 48:64), apps\api\src\modules\checklists\application\use-cases\update-checklist-item.use-case.ts (Line 33:33 - Line 44:31)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn60" onclick="toggleCodeBlock('cloneGroup60', 'expandBtn60', 'collapseBtn60')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn60" onclick="toggleCodeBlock('cloneGroup60', 'expandBtn60', 'collapseBtn60')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup60"><code class="language-typescript text-sm text-gray-800">, context);

    try {
      // 1. Buscar checklist
      const checklist = await this.repository.findInstanceById(dto.checklistId);
      if (!checklist) {
        throw new NotFoundException(
          `Checklist ${dto.checklistId} no encontrado`,
        );
      }

      // 2. Completar manualmente (validación de dominio ocurre aquí)</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\application\dto\checklist-response.dto.ts (Line 33:21 - Line 43:2), apps\api\src\modules\formularios\application\dto\form-template-response.dto.ts (Line 35:24 - Line 45:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn61" onclick="toggleCodeBlock('cloneGroup61', 'expandBtn61', 'collapseBtn61')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn61" onclick="toggleCodeBlock('cloneGroup61', 'expandBtn61', 'collapseBtn61')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup61"><code class="language-typescript text-sm text-gray-800"> {
  @ApiProperty()
  id!: string;

  @ApiProperty()
  name!: string;

  @ApiPropertyOptional()
  description?: string;

  @ApiProperty({</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\application\dto\assign-checklist.dto.ts (Line 35:12 - Line 45:1), apps\api\src\modules\checklists\application\dto\assign-checklist.dto.ts (Line 17:8 - Line 27:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn62" onclick="toggleCodeBlock('cloneGroup62', 'expandBtn62', 'collapseBtn62')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn62" onclick="toggleCodeBlock('cloneGroup62', 'expandBtn62', 'collapseBtn62')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup62"><code class="language-typescript text-sm text-gray-800">!: string;

  @ApiProperty({
    example: &quot;123e4567-e89b-12d3-a456-426614174000&quot;,
    description: &quot;ID del checklist template&quot;,
  })
  @IsString()
  @IsUUID()
  checklistId!: string;
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\auth\infrastructure\controllers\auth.controller.ts (Line 244:2 - Line 256:6), apps\api\src\modules\auth\infrastructure\controllers\auth.controller.ts (Line 198:2 - Line 210:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn63" onclick="toggleCodeBlock('cloneGroup63', 'expandBtn63', 'collapseBtn63')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn63" onclick="toggleCodeBlock('cloneGroup63', 'expandBtn63', 'collapseBtn63')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup63"><code class="language-typescript text-sm text-gray-800">
    @Req() req: Request,
    @Body() body: { refreshToken?: string } = {},
    @Res({ passthrough: true }) res: Response,
  ) {
    const refreshToken =
      (req as RequestWithCookies).cookies?.refreshToken || body?.refreshToken;

    if ((req as RequestWithCookies).cookies?.refreshToken) {
      assertCsrf(req);
    }

    const</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\auth\domain\events\user-logged-out.event.ts (Line 12:3 - Line 24:3), apps\api\src\modules\auth\domain\events\user-registered.event.ts (Line 16:10 - Line 28:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn64" onclick="toggleCodeBlock('cloneGroup64', 'expandBtn64', 'collapseBtn64')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn64" onclick="toggleCodeBlock('cloneGroup64', 'expandBtn64', 'collapseBtn64')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup64"><code class="language-typescript text-sm text-gray-800">?: string,
  ) {
    this.occurredAt = new Date();
    Object.freeze(this);
  }

  toJSON() {
    return {
      eventName: this.eventName,
      occurredAt: this.occurredAt.toISOString(),
      payload: {
        userId: this.userId,
        ip</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\auth\domain\events\user-logged-in.event.ts (Line 12:6 - Line 27:3), apps\api\src\modules\auth\domain\events\user-registered.event.ts (Line 14:5 - Line 29:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn65" onclick="toggleCodeBlock('cloneGroup65', 'expandBtn65', 'collapseBtn65')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn65" onclick="toggleCodeBlock('cloneGroup65', 'expandBtn65', 'collapseBtn65')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup65"><code class="language-typescript text-sm text-gray-800">: string,
    public readonly ip?: string,
    public readonly userAgent?: string,
  ) {
    this.occurredAt = new Date();
    Object.freeze(this);
  }

  toJSON() {
    return {
      eventName: this.eventName,
      occurredAt: this.occurredAt.toISOString(),
      payload: {
        userId: this.userId,
        email: this.email,
        ip</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\auth\domain\events\token-refreshed.event.ts (Line 12:11 - Line 26:11), apps\api\src\modules\auth\domain\events\user-registered.event.ts (Line 14:5 - Line 28:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn66" onclick="toggleCodeBlock('cloneGroup66', 'expandBtn66', 'collapseBtn66')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn66" onclick="toggleCodeBlock('cloneGroup66', 'expandBtn66', 'collapseBtn66')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup66"><code class="language-typescript text-sm text-gray-800">: string,
    public readonly ip?: string,
    public readonly userAgent?: string,
  ) {
    this.occurredAt = new Date();
    Object.freeze(this);
  }

  toJSON() {
    return {
      eventName: this.eventName,
      occurredAt: this.occurredAt.toISOString(),
      payload: {
        userId: this.userId,
        oldTokenId</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\auth\domain\entities\auth-session.entity.ts (Line 119:2 - Line 134:13), apps\api\src\modules\tecnicos\domain\entities\tecnico.entity.ts (Line 189:2 - Line 204:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn67" onclick="toggleCodeBlock('cloneGroup67', 'expandBtn67', 'collapseBtn67')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn67" onclick="toggleCodeBlock('cloneGroup67', 'expandBtn67', 'collapseBtn67')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup67"><code class="language-typescript text-sm text-gray-800">;
  }

  clearEvents(): void {
    this._domainEvents = [];
  }

  protected addDomainEvent(event: any): void {
    this._domainEvents.push(event);
  }

  toJSON() {
    return {
      id: this.id,
      userId: this.userId,
      refreshToken</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\auth\application\use-cases\reset-password.use-case.ts (Line 24:20 - Line 34:39), apps\api\src\modules\auth\application\use-cases\validate-reset-token.use-case.ts (Line 19:25 - Line 29:53)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn68" onclick="toggleCodeBlock('cloneGroup68', 'expandBtn68', 'collapseBtn68')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn68" onclick="toggleCodeBlock('cloneGroup68', 'expandBtn68', 'collapseBtn68')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup68"><code class="language-typescript text-sm text-gray-800">&gt; {
    try {
      // 1. Buscar todos los tokens activos (no usados y no expirados)
      const tokens = await this.prisma.passwordResetToken.findMany({
        where: {
          usedAt: null, // Solo tokens no usados
          expiresAt: { gt: new Date() },
        },
      });

      // 2. Verificar token contra cada hash</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\events\alerta-fallida.event.ts (Line 34:6 - Line 46:15), apps\api\src\modules\alertas\domain\events\preferencia-actualizada.event.ts (Line 31:8 - Line 43:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn69" onclick="toggleCodeBlock('cloneGroup69', 'expandBtn69', 'collapseBtn69')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn69" onclick="toggleCodeBlock('cloneGroup69', 'expandBtn69', 'collapseBtn69')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup69"><code class="language-typescript text-sm text-gray-800">;
    this.timestamp = props.timestamp;
    Object.freeze(this); // Inmutabilidad
  }

  /**
   * Serialización para logging/auditoría
   */
  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      destinatarioId</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\events\alerta-enviada.event.ts (Line 30:15 - Line 42:6), apps\api\src\modules\alertas\domain\events\preferencia-actualizada.event.ts (Line 31:8 - Line 43:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn70" onclick="toggleCodeBlock('cloneGroup70', 'expandBtn70', 'collapseBtn70')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn70" onclick="toggleCodeBlock('cloneGroup70', 'expandBtn70', 'collapseBtn70')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup70"><code class="language-typescript text-sm text-gray-800">;
    this.timestamp = props.timestamp;
    Object.freeze(this); // Inmutabilidad
  }

  /**
   * Serialización para logging/auditoría
   */
  public toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      aggregateId: this.aggregateId,
      canal</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\entities\preferencia-alerta.entity.ts (Line 218:20 - Line 229:3), apps\api\src\modules\checklists\domain\entities\checklist.entity.ts (Line 656:14 - Line 667:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn71" onclick="toggleCodeBlock('cloneGroup71', 'expandBtn71', 'collapseBtn71')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn71" onclick="toggleCodeBlock('cloneGroup71', 'expandBtn71', 'collapseBtn71')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup71"><code class="language-typescript text-sm text-gray-800">,
      createdAt: this._createdAt,
      updatedAt: this._updatedAt,
    };
  }

  // ═══════════════════════════════════════════════════════════════
  // VALIDACIONES
  // ═══════════════════════════════════════════════════════════════

  private validate(): void {
    if</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\entities\base-domain.entity.ts (Line 15:10 - Line 26:7), apps\api\src\modules\formularios\domain\entities\form-submission.entity.ts (Line 326:13 - Line 337:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn72" onclick="toggleCodeBlock('cloneGroup72', 'expandBtn72', 'collapseBtn72')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn72" onclick="toggleCodeBlock('cloneGroup72', 'expandBtn72', 'collapseBtn72')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup72"><code class="language-typescript text-sm text-gray-800">;
  }

  public getCreatedAt(): Date {
    return this._createdAt;
  }

  public getUpdatedAt(): Date {
    return this._updatedAt;
  }

  public</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\entities\alerta.entity.ts (Line 50:2 - Line 64:6), apps\api\src\modules\alertas\domain\entities\preferencia-alerta.entity.ts (Line 25:2 - Line 39:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn73" onclick="toggleCodeBlock('cloneGroup73', 'expandBtn73', 'collapseBtn73')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn73" onclick="toggleCodeBlock('cloneGroup73', 'expandBtn73', 'collapseBtn73')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup73"><code class="language-typescript text-sm text-gray-800">,
    createdAt: Date = new Date(),
    updatedAt: Date = new Date(),
  ) {
    super(createdAt, updatedAt);
    this.validate();
  }

  // ═══════════════════════════════════════════════════════════════
  // FACTORY METHODS
  // ═══════════════════════════════════════════════════════════════

  /**
   * Crear nueva alerta
   */</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\entities\alerta.entity.ts (Line 362:2 - Line 377:2), apps\api\src\modules\alertas\domain\entities\alerta.entity.ts (Line 148:6 - Line 163:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn74" onclick="toggleCodeBlock('cloneGroup74', 'expandBtn74', 'collapseBtn74')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn74" onclick="toggleCodeBlock('cloneGroup74', 'expandBtn74', 'collapseBtn74')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup74"><code class="language-typescript text-sm text-gray-800">: {
    id: string;
    tipo: string;
    prioridad: string;
    titulo: string;
    mensaje: string;
    destinatarioId: string;
    canales: string[];
    estado: string;
    intentosEnvio: number;
    enviadaEn?: Date;
    leidaEn?: Date;
    metadata?: Record&lt;string, any&gt;;
    createdAt: Date;
    updatedAt: Date;
  } </code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\domain\entities\alerta.entity.ts (Line 390:10 - Line 401:52), apps\api\src\modules\checklists\domain\entities\checklist.entity.ts (Line 656:14 - Line 667:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn75" onclick="toggleCodeBlock('cloneGroup75', 'expandBtn75', 'collapseBtn75')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn75" onclick="toggleCodeBlock('cloneGroup75', 'expandBtn75', 'collapseBtn75')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup75"><code class="language-typescript text-sm text-gray-800">,
      createdAt: this._createdAt,
      updatedAt: this._updatedAt,
    };
  }

  // ═══════════════════════════════════════════════════════════════
  // VALIDACIONES
  // ═══════════════════════════════════════════════════════════════

  private validate(): void {
    // Invariantes que involucren múltiples propiedades</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\application\use-cases\obtener-historial-alertas.use-case.ts (Line 45:13 - Line 56:1), apps\api\src\modules\checklists\application\use-cases\list-checklists.use-case.ts (Line 47:16 - Line 58:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn76" onclick="toggleCodeBlock('cloneGroup76', 'expandBtn76', 'collapseBtn76')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn76" onclick="toggleCodeBlock('cloneGroup76', 'expandBtn76', 'collapseBtn76')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup76"><code class="language-typescript text-sm text-gray-800">.toResponseDtoArray(result.items);

    return {
      items,
      total: result.total,
      page,
      limit,
      totalPages: Math.ceil(result.total / limit),
    };
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\infrastructure\controllers\admin.controller.ts (Line 30:23 - Line 41:18), apps\api\src\modules\hes\infrastructure\controllers\hes.controller.ts (Line 27:2 - Line 38:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn77" onclick="toggleCodeBlock('cloneGroup77', 'expandBtn77', 'collapseBtn77')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn77" onclick="toggleCodeBlock('cloneGroup77', 'expandBtn77', 'collapseBtn77')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup77"><code class="language-typescript text-sm text-gray-800">
import { JwtAuthGuard } from &quot;../../../../common/guards/jwt-auth.guard&quot;;
import { RolesGuard } from &quot;../../../../common/guards/roles.guard&quot;;
import { Roles } from &quot;../../../../common/decorators/roles.decorator&quot;;
import {
  CurrentUser,
  JwtPayload,
} from &quot;../../../../common/decorators/current-user.decorator&quot;;

// Use Cases
import {
  CreateUserUseCase</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\domain\repositories\user.repository.interface.ts (Line 14:4 - Line 25:4), apps\api\src\modules\cierre-administrativo\domain\repositories\cierre.repository.interface.ts (Line 20:1 - Line 29:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn78" onclick="toggleCodeBlock('cloneGroup78', 'expandBtn78', 'collapseBtn78')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn78" onclick="toggleCodeBlock('cloneGroup78', 'expandBtn78', 'collapseBtn78')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup78"><code class="language-typescript text-sm text-gray-800">
export interface PaginatedResult&lt;T&gt; {
  data: T[];
  total: number;
  page: number;
  pageSize: number;
  totalPages: number;
}

/**
 * Filtros para búsqueda de usuarios
 */</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\domain\events\user-deactivated.event.ts (Line 15:7 - Line 27:10), apps\api\src\modules\admin\domain\events\user-updated.event.ts (Line 20:10 - Line 32:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn79" onclick="toggleCodeBlock('cloneGroup79', 'expandBtn79', 'collapseBtn79')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn79" onclick="toggleCodeBlock('cloneGroup79', 'expandBtn79', 'collapseBtn79')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup79"><code class="language-typescript text-sm text-gray-800">?: string,
  ) {
    this.occurredAt = new Date();
  }

  /**
   * Serializa el evento para logging/auditoría
   */
  toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      userId: this.userId,
      userEmail</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\domain\events\user-created.event.ts (Line 16:10 - Line 28:6), apps\api\src\modules\admin\domain\events\user-updated.event.ts (Line 20:10 - Line 32:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn80" onclick="toggleCodeBlock('cloneGroup80', 'expandBtn80', 'collapseBtn80')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn80" onclick="toggleCodeBlock('cloneGroup80', 'expandBtn80', 'collapseBtn80')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup80"><code class="language-typescript text-sm text-gray-800">?: string,
  ) {
    this.occurredAt = new Date();
  }

  /**
   * Serializa el evento para logging/auditoría
   */
  toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      userId: this.userId,
      email</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\domain\events\role-changed.event.ts (Line 16:10 - Line 29:8), apps\api\src\modules\admin\domain\events\user-updated.event.ts (Line 20:2 - Line 28:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn81" onclick="toggleCodeBlock('cloneGroup81', 'expandBtn81', 'collapseBtn81')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn81" onclick="toggleCodeBlock('cloneGroup81', 'expandBtn81', 'collapseBtn81')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup81"><code class="language-typescript text-sm text-gray-800">: string,
  ) {
    this.occurredAt = new Date();
  }

  /**
   * Serializa el evento para logging/auditoría
   */
  toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      userId: this.userId,
      userEmail: this.userEmail,
      oldRole</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\domain\events\password-reset.event.ts (Line 15:6 - Line 28:8), apps\api\src\modules\admin\domain\events\user-updated.event.ts (Line 20:7 - Line 28:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn82" onclick="toggleCodeBlock('cloneGroup82', 'expandBtn82', 'collapseBtn82')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn82" onclick="toggleCodeBlock('cloneGroup82', 'expandBtn82', 'collapseBtn82')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup82"><code class="language-typescript text-sm text-gray-800">,
  ) {
    this.occurredAt = new Date();
  }

  /**
   * Serializa el evento para logging/auditoría
   */
  toJSON(): Record&lt;string, unknown&gt; {
    return {
      eventName: this.eventName,
      userId: this.userId,
      userEmail: this.userEmail,
      resetBy</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\application\use-cases\toggle-user-active.use-case.ts (Line 88:2 - Line 102:1), apps\api\src\modules\admin\application\use-cases\update-user.use-case.ts (Line 55:2 - Line 69:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn83" onclick="toggleCodeBlock('cloneGroup83', 'expandBtn83', 'collapseBtn83')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn83" onclick="toggleCodeBlock('cloneGroup83', 'expandBtn83', 'collapseBtn83')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup83"><code class="language-typescript text-sm text-gray-800">;
  }

  /**
   * Publica eventos de dominio
   */
  private publishDomainEvents(user: any): void {
    const events = user.getDomainEvents();
    events.forEach((event: any) =&gt; {
      this.eventEmitter.emit(event.eventName, event);
    });
    user.clearDomainEvents();
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\application\use-cases\reset-password.use-case.ts (Line 58:2 - Line 73:1), apps\api\src\modules\admin\application\use-cases\toggle-user-active.use-case.ts (Line 87:7 - Line 69:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn84" onclick="toggleCodeBlock('cloneGroup84', 'expandBtn84', 'collapseBtn84')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn84" onclick="toggleCodeBlock('cloneGroup84', 'expandBtn84', 'collapseBtn84')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup84"><code class="language-typescript text-sm text-gray-800">}`,
    };
  }

  /**
   * Publica eventos de dominio
   */
  private publishDomainEvents(user: any): void {
    const events = user.getDomainEvents();
    events.forEach((event: any) =&gt; {
      this.eventEmitter.emit(event.eventName, event);
    });
    user.clearDomainEvents();
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\application\use-cases\change-user-role.use-case.ts (Line 5:4 - Line 19:7), apps\api\src\modules\admin\application\use-cases\toggle-user-active.use-case.ts (Line 5:4 - Line 20:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn85" onclick="toggleCodeBlock('cloneGroup85', 'expandBtn85', 'collapseBtn85')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn85" onclick="toggleCodeBlock('cloneGroup85', 'expandBtn85', 'collapseBtn85')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup85"><code class="language-typescript text-sm text-gray-800">

import {
  Inject,
  Injectable,
  NotFoundException,
  BadRequestException,
  Logger,
} from &quot;@nestjs/common&quot;;
import { EventEmitter2 } from &quot;@nestjs/event-emitter&quot;;
import {
  IUserRepository,
  USER_REPOSITORY,
} from &quot;../../domain/repositories/user.repository.interface&quot;;
import</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\application\use-cases\change-user-role.use-case.ts (Line 83:1 - Line 98:1), apps\api\src\modules\admin\application\use-cases\create-user.use-case.ts (Line 58:19 - Line 73:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn86" onclick="toggleCodeBlock('cloneGroup86', 'expandBtn86', 'collapseBtn86')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn86" onclick="toggleCodeBlock('cloneGroup86', 'expandBtn86', 'collapseBtn86')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup86"><code class="language-typescript text-sm text-gray-800">
    return UserMapper.toResponse(savedUser);
  }

  /**
   * Publica eventos de dominio
   */
  private publishDomainEvents(user: UserEntity): void {
    const events = user.getDomainEvents();
    events.forEach((event) =&gt; {
      this.eventEmitter.emit(event.eventName, event);
    });
    user.clearDomainEvents();
  }
}
</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\application\dto\create-user.dto.ts (Line 56:2 - Line 66:5), apps\api\src\modules\admin\application\dto\user-response.dto.ts (Line 19:1 - Line 29:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn87" onclick="toggleCodeBlock('cloneGroup87', 'expandBtn87', 'collapseBtn87')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn87" onclick="toggleCodeBlock('cloneGroup87', 'expandBtn87', 'collapseBtn87')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup87"><code class="language-typescript text-sm text-gray-800">
  @ApiProperty({
    example: &quot;tecnico@cermont.com&quot;,
    description: &quot;Email del usuario&quot;,
  })
  email!: string;

  @ApiProperty({
    example: &quot;Juan Pérez&quot;,
    description: &quot;Nombre completo&quot;,
    </code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\application\dto\create-user.dto.ts (Line 81:15 - Line 96:2), apps\api\src\modules\admin\application\dto\user-response.dto.ts (Line 34:18 - Line 50:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn88" onclick="toggleCodeBlock('cloneGroup88', 'expandBtn88', 'collapseBtn88')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn88" onclick="toggleCodeBlock('cloneGroup88', 'expandBtn88', 'collapseBtn88')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup88"><code class="language-typescript text-sm text-gray-800">,
  })
  role!: UserRoleType;

  @ApiPropertyOptional({
    example: &quot;+57 3001234567&quot;,
    description: &quot;Teléfono de contacto&quot;,
  })
  phone?: string;

  @ApiPropertyOptional({
    example: &quot;https://example.com/avatar.jpg&quot;,
    description: &quot;URL del avatar&quot;,
  })
  avatar?: string;
}</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\notifications\email\email-queue.service.ts (Line 175:16 - Line 185:6), apps\api\src\modules\alertas\infrastructure\queue\notification-queue.service.ts (Line 74:12 - Line 84:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn89" onclick="toggleCodeBlock('cloneGroup89', 'expandBtn89', 'collapseBtn89')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn89" onclick="toggleCodeBlock('cloneGroup89', 'expandBtn89', 'collapseBtn89')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup89"><code class="language-typescript text-sm text-gray-800">) {
      this.useBullMQ = true;
      this.initializeBullMQ();
    } else {
      this.useBullMQ = false;
      this.initializeMockQueue();
    }
  }

  private initializeBullMQ(): void {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\dto\kit.dto.ts (Line 38:21 - Line 53:13), apps\api\src\modules\kits\dto\kit.dto.ts (Line 22:24 - Line 37:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn90" onclick="toggleCodeBlock('cloneGroup90', 'expandBtn90', 'collapseBtn90')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn90" onclick="toggleCodeBlock('cloneGroup90', 'expandBtn90', 'collapseBtn90')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup90"><code class="language-typescript text-sm text-gray-800"> })
  @IsString()
  @IsNotEmpty()
  nombre!: string;

  @ApiProperty({ example: 1, minimum: 1 })
  @IsNumber()
  @Min(1)
  cantidad!: number;

  @ApiProperty({ example: true })
  @IsBoolean()
  certificacion!: boolean;
}

export class CreateKitDto</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\dto\admin.dto.ts (Line 185:16 - Line 199:1), apps\api\src\modules\checklists\application\dto\checklist-response.dto.ts (Line 88:21 - Line 101:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn91" onclick="toggleCodeBlock('cloneGroup91', 'expandBtn91', 'collapseBtn91')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn91" onclick="toggleCodeBlock('cloneGroup91', 'expandBtn91', 'collapseBtn91')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup91"><code class="language-typescript text-sm text-gray-800">[];

  @ApiProperty()
  total!: number;

  @ApiProperty()
  page!: number;

  @ApiProperty()
  limit!: number;

  @ApiProperty()
  totalPages!: number;

</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\shared\mappers\orden.mapper.ts (Line 108:2 - Line 122:2), apps\api\src\shared\mappers\orden.mapper.ts (Line 60:2 - Line 74:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn92" onclick="toggleCodeBlock('cloneGroup92', 'expandBtn92', 'collapseBtn92')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn92" onclick="toggleCodeBlock('cloneGroup92', 'expandBtn92', 'collapseBtn92')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup92"><code class="language-typescript text-sm text-gray-800">
      numero:
        numeroValue instanceof OrdenNumero
          ? numeroValue.getValue()
          : String(numeroValue),
      monto:
        montoValue instanceof Monto
          ? montoValue.getValue()
          : Number(montoValue),
      estado:
        estadoValue instanceof OrdenEstado
          ? estadoValue.getValue()
          : String(estadoValue),
      clienteId: entity.clienteId as string,
      descripcion: entity.descripcion as string,</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\sync\sync.service.ts (Line 196:6 - Line 206:19), apps\api\src\modules\sync\sync.service.ts (Line 173:8 - Line 183:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn93" onclick="toggleCodeBlock('cloneGroup93', 'expandBtn93', 'collapseBtn93')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn93" onclick="toggleCodeBlock('cloneGroup93', 'expandBtn93', 'collapseBtn93')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup93"><code class="language-typescript text-sm text-gray-800">,
          completadoPorId: datos.completada ? userId : null,
          completadoEn: datos.completada ? new Date() : null,
        },
      });

      return {
        success: true,
        id: item.id,
        tipo: item.tipo,
        mensaje: &quot;Checklist creado&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\kits\kits.service.ts (Line 457:16 - Line 467:19), apps\api\src\modules\kits\kits.service.ts (Line 372:6 - Line 382:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn94" onclick="toggleCodeBlock('cloneGroup94', 'expandBtn94', 'collapseBtn94')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn94" onclick="toggleCodeBlock('cloneGroup94', 'expandBtn94', 'collapseBtn94')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup94"><code class="language-typescript text-sm text-gray-800">);

    const ejecucion = await this.prisma.ejecucion.findUnique({
      where: { id: ejecucionId },
    });

    if (!ejecucion) {
      throw new NotFoundException(&quot;Ejecución no encontrada&quot;);
    }

    const checklistPrincipal</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\facturacion\facturacion.service.ts (Line 135:19 - Line 145:35), apps\api\src\modules\facturacion\facturacion.service.ts (Line 98:15 - Line 108:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn95" onclick="toggleCodeBlock('cloneGroup95', 'expandBtn95', 'collapseBtn95')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn95" onclick="toggleCodeBlock('cloneGroup95', 'expandBtn95', 'collapseBtn95')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup95"><code class="language-typescript text-sm text-gray-800">&gt; {
    const ses = await this.prisma.sES.findUnique({
      where: { id: dto.sesId },
      include: { orden: true },
    });

    if (!ses) {
      throw new NotFoundException(`SES ${dto.sesId} no encontrado`);
    }

    // Check if factura already exists</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\evidencias\evidencias.service.ts (Line 145:12 - Line 156:44), apps\api\src\modules\evidencias\evidencias.service.ts (Line 117:8 - Line 128:40)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn96" onclick="toggleCodeBlock('cloneGroup96', 'expandBtn96', 'collapseBtn96')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn96" onclick="toggleCodeBlock('cloneGroup96', 'expandBtn96', 'collapseBtn96')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup96"><code class="language-typescript text-sm text-gray-800"> });
      const data = evidencias.map((e) =&gt; this.mapEvidenciaToResponse(e));

      this.logger.log(&quot;Evidencias obtenidas exitosamente&quot;, {
        ...context,
        count: evidencias.length,
      });

      return { data };
    } catch (error) {
      const err = error as Error;
      this.logger.error(&quot;Error obteniendo evidencias por ejecución&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\evidencias\evidencias.service.ts (Line 156:44 - Line 167:6), apps\api\src\modules\evidencias\evidencias.service.ts (Line 128:40 - Line 139:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn97" onclick="toggleCodeBlock('cloneGroup97', 'expandBtn97', 'collapseBtn97')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn97" onclick="toggleCodeBlock('cloneGroup97', 'expandBtn97', 'collapseBtn97')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup97"><code class="language-typescript text-sm text-gray-800">, {
        ...context,
        error: err.message,
        stack: err.stack,
      });
      throw new InternalServerErrorException(&quot;Error obteniendo evidencias&quot;);
    }
  }

  /**
   * ✅ SUBIR NUEVA EVIDENCIA (CON VALIDACIÓN DE SEGURIDAD)
   */</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\ejecucion\ejecucion.service.ts (Line 110:18 - Line 121:24), apps\api\src\modules\ejecucion\application\use-cases\iniciar-ejecucion.use-case.ts (Line 44:35 - Line 55:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn98" onclick="toggleCodeBlock('cloneGroup98', 'expandBtn98', 'collapseBtn98')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn98" onclick="toggleCodeBlock('cloneGroup98', 'expandBtn98', 'collapseBtn98')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup98"><code class="language-typescript text-sm text-gray-800">
    const planeacion = await this.prisma.planeacion.findUnique({
      where: { ordenId },
    });

    if (!planeacion || planeacion.estado !== &quot;aprobada&quot;) {
      throw new BadRequestException(
        &quot;No existe planeación aprobada para esta orden&quot;,
      );
    }

    // Create domain entity</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\checklists\checklists.module.ts (Line 12:24 - Line 24:26), apps\api\src\modules\checklists\infrastructure\controllers\checklists.controller.ts (Line 23:55 - Line 35:30)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn99" onclick="toggleCodeBlock('cloneGroup99', 'expandBtn99', 'collapseBtn99')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn99" onclick="toggleCodeBlock('cloneGroup99', 'expandBtn99', 'collapseBtn99')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup99"><code class="language-typescript text-sm text-gray-800">;
import {
  CreateChecklistUseCase,
  ListChecklistsUseCase,
  AssignChecklistToOrdenUseCase,
  AssignChecklistToEjecucionUseCase,
  GetChecklistsByOrdenUseCase,
  GetChecklistsByEjecucionUseCase,
  ToggleChecklistItemUseCase,
  UpdateChecklistItemUseCase,
  CompleteChecklistUseCase,
  ArchiveChecklistUseCase,
} from &quot;./application/use-cases&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\certificaciones\certificaciones.controller.ts (Line 4:5 - Line 18:23), apps\api\src\modules\clientes\clientes.controller.ts (Line 6:7 - Line 20:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn100" onclick="toggleCodeBlock('cloneGroup100', 'expandBtn100', 'collapseBtn100')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn100" onclick="toggleCodeBlock('cloneGroup100', 'expandBtn100', 'collapseBtn100')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup100"><code class="language-typescript text-sm text-gray-800">,
  Body,
  Param,
  Query,
  UseGuards,
} from &quot;@nestjs/common&quot;;
import {
  ApiTags,
  ApiOperation,
  ApiResponse,
  ApiBearerAuth,
  ApiQuery,
} from &quot;@nestjs/swagger&quot;;
import { JwtAuthGuard } from &quot;../../common/guards/jwt-auth.guard&quot;;
import { CertificacionesService</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\alertas\alertas.service.ts (Line 38:1 - Line 50:4), apps\api\src\modules\alertas\application\use-cases\detectar-actas-sin-firmar.use-case.ts (Line 37:27 - Line 49:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn101" onclick="toggleCodeBlock('cloneGroup101', 'expandBtn101', 'collapseBtn101')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn101" onclick="toggleCodeBlock('cloneGroup101', 'expandBtn101', 'collapseBtn101')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup101"><code class="language-typescript text-sm text-gray-800">
    const actasPendientes = await this.prisma.acta.findMany({
      where: {
        estado: { in: [&quot;generada&quot;, &quot;enviada&quot;] as any },
        fechaEmision: { lt: fechaLimite },
        alertaEnviada: false,
      },
      include: {
        orden: { select: { id: true, numero: true, asignadoId: true } },
      },
    });

    for</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\modules\admin\admin.service.ts (Line 286:7 - Line 297:51), apps\api\src\modules\admin\admin.service.ts (Line 248:8 - Line 157:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn102" onclick="toggleCodeBlock('cloneGroup102', 'expandBtn102', 'collapseBtn102')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn102" onclick="toggleCodeBlock('cloneGroup102', 'expandBtn102', 'collapseBtn102')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup102"><code class="language-typescript text-sm text-gray-800">,
    adminUserId: string,
  ): Promise&lt;{ success: boolean; message: string }&gt; {
    const user = await this.prisma.user.findUnique({
      where: { id: userId },
    });

    if (!user) {
      throw new NotFoundException(`Usuario ${userId} no encontrado`);
    }

    // Hashear contraseña usando servicio centralizado</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\lib\logging\logger.service.ts (Line 196:2 - Line 210:9), apps\api\src\lib\logging\logger.service.ts (Line 170:7 - Line 184:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn103" onclick="toggleCodeBlock('cloneGroup103', 'expandBtn103', 'collapseBtn103')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn103" onclick="toggleCodeBlock('cloneGroup103', 'expandBtn103', 'collapseBtn103')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup103"><code class="language-typescript text-sm text-gray-800">,
  ): void {
    const level: LogLevel =
      statusCode &gt;= 500 ? &quot;error&quot; : statusCode &gt;= 400 ? &quot;warn&quot; : &quot;log&quot;;
    this.write(
      level,
      `[HTTP] ${method} ${sanitizeUrl(url)} ${statusCode} - ${durationMs}ms`,
      &quot;HTTP&quot;,
      {
        method,
        url: sanitizeUrl(url),
        statusCode,
        durationMs,
        userId,
        </code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\common\filters\all-exceptions.filter.ts (Line 1:1 - Line 11:2), apps\api\src\common\filters\http-exception.filter.ts (Line 1:1 - Line 11:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn104" onclick="toggleCodeBlock('cloneGroup104', 'expandBtn104', 'collapseBtn104')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn104" onclick="toggleCodeBlock('cloneGroup104', 'expandBtn104', 'collapseBtn104')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup104"><code class="language-typescript text-sm text-gray-800">import {
  ExceptionFilter,
  Catch,
  ArgumentsHost,
  HttpException,
  HttpStatus,
  Logger,
} from &quot;@nestjs/common&quot;;
import { Response, Request } from &quot;express&quot;;

@Catch()</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\common\filters\all-exceptions.filter.ts (Line 78:2 - Line 93:1), apps\api\src\common\filters\http-exception.filter.ts (Line 38:6 - Line 52:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn105" onclick="toggleCodeBlock('cloneGroup105', 'expandBtn105', 'collapseBtn105')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn105" onclick="toggleCodeBlock('cloneGroup105', 'expandBtn105', 'collapseBtn105')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup105"><code class="language-typescript text-sm text-gray-800">,
    );

    // Respuesta estructurada
    response.status(status).json({
      success: false,
      statusCode: status,
      message,
      errors,
      timestamp: new Date().toISOString(),
      path: request.url,
      method: request.method,
    });
  }

</code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\common\dto\pagination.dto.ts (Line 88:19 - Line 101:3), apps\api\src\common\dto\pagination.dto.ts (Line 63:13 - Line 76:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn106" onclick="toggleCodeBlock('cloneGroup106', 'expandBtn106', 'collapseBtn106')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn106" onclick="toggleCodeBlock('cloneGroup106', 'expandBtn106', 'collapseBtn106')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup106"><code class="language-typescript text-sm text-gray-800"> {
  @ApiPropertyOptional({
    description: &quot;Campo por el cual ordenar&quot;,
    example: &quot;createdAt&quot;,
  })
  @IsOptional()
  @IsString({ message: &quot;sortBy debe ser un string&quot; })
  sortBy?: string;

  @ApiPropertyOptional({
    enum: [&quot;asc&quot;, &quot;desc&quot;],
    default: &quot;desc&quot;,
    description: &quot;Dirección del ordenamiento&quot;,
  </code></pre></div><div class="py-4"><p class="text-gray-600">apps\api\src\common\base\base.service.ts (Line 10:2 - Line 20:9), apps\api\src\modules\cierre-administrativo\domain\repositories\cierre.repository.interface.ts (Line 19:2 - Line 29:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn107" onclick="toggleCodeBlock('cloneGroup107', 'expandBtn107', 'collapseBtn107')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn107" onclick="toggleCodeBlock('cloneGroup107', 'expandBtn107', 'collapseBtn107')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup107"><code class="language-typescript text-sm text-gray-800">

export interface PaginatedResult&lt;T&gt; {
  data: T[];
  total: number;
  page: number;
  pageSize: number;
  totalPages: number;
}

export function</code></pre></div><!-- Add more clone groups for .txt format as needed         // Add more clone groups for .txt format as needed--></div></section><!-- Add more sections for other formats and clone groups as needed--></main><footer class="bg-white shadow mt-8 py-4"><div class="container mx-auto px-4 text-center"><p class="text-sm text-gray-600">This report is generated by jscpd, an open-source copy/paste detector.</p><p class="text-sm text-gray-600">jscpd is licensed under the MIT License.</p><a class="text-blue-500 text-sm" href="https://github.com/kucherenko/jscpd" target="_blank" rel="noopener noreferrer">View jscpd on GitHub</a></div></footer><script src="js/prism.js"></script><script>function toggleCodeBlock(codeBlockId, expandBtnId, collapseBtnId) {
  const codeBlock = document.getElementById(codeBlockId);
  const expandBtn = document.getElementById(expandBtnId);
  const collapseBtn = document.getElementById(collapseBtnId);

  codeBlock.classList.toggle('hidden');
  expandBtn.classList.toggle('hidden');
  collapseBtn.classList.toggle('hidden');
}</script></body></html>