/**
 * Utilidades para impresión y exportación a PDF
 * Optimiza el layout para impresión en papel A4
 */

@media print {
  /* === Configuración de página === */
  @page {
    size: A4 portrait;
    margin: 10mm;
  }

  /* === Ocultar elementos no imprimibles === */
  .no-print,
  .navbar,
  .navbar-toggle,
  .mobile-panel,
  .form-actions,
  .btn:not(.print-btn),
  .theme-btn,
  button:not(.print-btn),
  .preview-remove,
  .picker-btn,
  .picker-row {
    display: none !important;
  }

  /* === Optimizar para impresión === */
  html,
  body {
    width: 210mm;
    margin: 0;
    /* no forzar blanco: respetar colores/gradientes del tema */
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    font-size: 11pt;
    line-height: 1.3;
  }

  /* === Contenedores === */
  .container,
  .print-sheet {
    max-width: 190mm !important;
    width: 100% !important;
    padding: 0 !important;
    margin: 0 auto !important;
  }

  /* === Eliminar sombras === */
  .form-card,
  .card,
  .shadow,
  .shadow-lg {
    box-shadow: none !important;
    background: #fff !important;
    border-color: #cfd8e3 !important;
  }

  /* === Prevenir saltos de página === */
  .form-section,
  .card,
  .no-break {
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }

  /* === Tablas === */
  table {
    border-collapse: collapse;
  }

  th,
  td {
    border: 1px solid #ddd;
    padding: 8px;
  }

  /* === Enlaces === */
  a {
    text-decoration: none;
    color: inherit;
  }

  /* Mostrar URLs de enlaces importantes */
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }

  /* === Imágenes === */
  img {
    max-width: 100% !important;
    page-break-inside: avoid;
  }

  /* === Encabezados === */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    break-after: avoid;
    page-break-after: avoid;
  }
  /* Evitar que legend quede solo al final de página */
  legend { break-after: avoid; page-break-after: avoid; }

  /* === Inputs en impresión === */
  input,
  textarea,
  select {
    border: 1px solid #999 !important;
    background: #fff !important;
    padding: 4pt 6pt !important;
    font-size: 10pt !important;
  }

  /* === Grids responsivos forzados === */
  .grid-2 {
    grid-template-columns: 1fr 1fr !important;
    gap: 6pt !important;
  }

  .grid-3 {
    grid-template-columns: 1fr 1fr 1fr !important;
    gap: 6pt !important;
  }

  .grid-12 {
    grid-template-columns: repeat(12, 1fr) !important;
    gap: 6pt !important;
  }

  /* === Clase especial para modo impresión compacta === */
  html.print-one .form-card {
    padding: 12px;
  }

  html.print-one .form-section {
    margin: 10px 0;
  }

  html.print-one .field {
    padding: 6px;
  }
}

/* === Clases de utilidad para impresión === */
.print-only {
  display: none;
}

@media print {
  .print-only {
    display: block !important;
  }
}

.page-break {
  page-break-before: always;
}

.avoid-break {
  page-break-inside: avoid;
}

/* Agrupar 3 secciones por hoja (utilidad opcional) */
@media print {
  .page-3-per-sheet > .form-section { break-inside: avoid; page-break-inside: avoid; }
  .page-3-per-sheet > .form-section:nth-of-type(3n+4) { break-before: page; page-break-before: always; }
}
