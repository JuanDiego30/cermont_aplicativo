import { Router } from 'express';
import { getAllOrders, getOrderById, createOrder, updateOrder, deleteOrder, addNote, updateOrderStatus, assignUsers, getOrderStats, archiveOrder, } from '';
import { authenticate } from '';
import { requireMinRole, requireAdmin } from '';
import { validateObjectId } from '';
import { createRateLimiter } from '';
import { auditLogger } from '';
import { cacheMiddleware, invalidateCache, invalidateCacheById } from '';
import { sanitizeQuery } from '';
const router = Router();
router.use(authenticate);
router.get('/stats', sanitizeQuery, requireMinRole('engineer'), cacheMiddleware(300), getOrderStats);
router.get('/', sanitizeQuery, cacheMiddleware(60), getAllOrders);
router.get('/:id', validateObjectId('id'), cacheMiddleware(180), getOrderById);
router.post('/', requireMinRole('engineer'), createRateLimiter({ windowMs: 15 * 60 * 1000, max: 20 }), invalidateCache('orders:stats'), auditLogger('CREATE', 'Order'), createOrder);
router.put('/:id', validateObjectId('id'), requireMinRole('supervisor'), invalidateCacheById('orders'), auditLogger('UPDATE', 'Order'), updateOrder);
router.delete('/:id', validateObjectId('id'), requireAdmin, invalidateCacheById('orders'), auditLogger('DELETE', 'Order'), deleteOrder);
router.post('/:id/notes', validateObjectId('id'), invalidateCacheById('orders'), addNote);
router.patch('/:id/status', validateObjectId('id'), requireMinRole('supervisor'), invalidateCacheById('orders'), auditLogger('UPDATE', 'OrderStatus'), updateOrderStatus);
router.post('/:id/assign', validateObjectId('id'), requireMinRole('supervisor'), invalidateCacheById('orders'), auditLogger('UPDATE', 'OrderAssign'), assignUsers);
router.post('/:id/archive', validateObjectId('id'), requireAdmin, invalidateCache('orders:stats'), auditLogger('UPDATE', 'OrderArchive'), archiveOrder);
export default router;
//# sourceMappingURL=orders.routes.js.map