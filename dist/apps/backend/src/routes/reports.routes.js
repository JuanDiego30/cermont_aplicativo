import { Router } from 'express';
import { getAllCctvReports, getCctvReportById, createCctvReport, updateCctvReport, deleteCctvReport, approveCctvReport, getReportsByOrder, getCctvStats, } from '';
import { authenticate } from '';
import { requireMinRole } from '';
import { validateObjectId } from '';
import { createRateLimiter } from '';
import { auditLogger } from '';
import { cacheMiddleware, invalidateCache, invalidateCacheById } from '';
import { sanitizeQuery } from '';
const router = Router();
router.use(authenticate);
router.get('/stats', sanitizeQuery, requireMinRole('supervisor'), cacheMiddleware(300), getCctvStats);
router.get('/cctv', sanitizeQuery, cacheMiddleware(120), getAllCctvReports);
router.get('/cctv/:id', validateObjectId('id'), cacheMiddleware(300), getCctvReportById);
router.post('/cctv', requireMinRole('technician'), createRateLimiter({ windowMs: 15 * 60 * 1000, max: 10 }), invalidateCache('cctv:stats'), auditLogger('CREATE', 'CctvReport'), createCctvReport);
router.put('/cctv/:id', validateObjectId('id'), requireMinRole('engineer'), invalidateCacheById('cctv'), auditLogger('UPDATE', 'CctvReport'), updateCctvReport);
router.delete('/cctv/:id', validateObjectId('id'), requireMinRole('engineer'), invalidateCacheById('cctv'), auditLogger('DELETE', 'CctvReport'), deleteCctvReport);
router.post('/cctv/:id/approve', validateObjectId('id'), requireMinRole('supervisor'), invalidateCache('cctv:stats'), invalidateCacheById('cctv'), auditLogger('UPDATE', 'CctvReportApproval'), approveCctvReport);
router.get('/order/:orderId', validateObjectId('orderId'), sanitizeQuery, cacheMiddleware(180), getReportsByOrder);
export default router;
//# sourceMappingURL=reports.routes.js.map